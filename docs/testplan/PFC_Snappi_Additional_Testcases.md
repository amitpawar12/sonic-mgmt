This document describes the list of additional system testcases.

- [Background](#background)
- [Setup](#setup)
- [Testcases](#testcases)

### Background

Intent of these testcases is to test throughput at the interface speed, PFC, PFC-WD, ECN congestion, port-channels and MACSEC. These testcases will be executed for 100 and 400Gbps ports on single line-card single asic, single line-card multiple asic and multiple line-card. The packet-size will vary from 128 to 1400 bytes. 

Traffic pattern includes at least one lossless priority flow and with/without lossy background traffic. Some of the testcases use pause flows to simulate congestion.

Additionally, the testcases also intend to capture the utilization, packet-drops and/or latency.


### Setup
                                    ________________
                                    |               |
    IXIA(100/400Gbps) <--------->   |    DUT-LC1    |<---------> IXIA(100/400Gbps)
    IXIA(100/400Gbps) <--------->   |    ASIC0      |<---------> IXIA(100/400Gbps)
                                    |_______________|
                                    |_______________|
                                    |               |
    IXIA(100/400Gbps) <--------->   |    DUT-LC1    |<---------> IXIA(100/400Gbps)
    IXIA(100/400Gbps) <--------->   |    ASIC1      |<---------> IXIA(100/400Gbps)
                                    |_______________|

There will be similar setup on a different line-card in the same chassis. IXIA ports will be mix of 100 and 400Gbps.

### Testcases

| Test case ID | Test Case                                                                                         | Description                                                                                                                                                                                                                                                                      | LC combination                                | Pass-Fail Criteria                                                                                                                                                                                                                                                                                                                                                           |  
|-------------:|:--------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|           01 | Single 400Gbps Ingress and single 100Gbps egress - 1024B packet-size                              | - 90% of 400Gbps - Lossless Prio3 & Prio4<br>- 10% of 400Gbps - Lossy Background Flow [Prio0, 1, and 2]<br>- Enable pfcwd and credit-watchdog on ingress and egress.                                                                                                             | - Single LC - Multiple ASIC <br>- Multiple LC | 1. The single 100Gbps egress should see 100Gbps lossy+lossless traffic<br>2. The 40Gbps lossy traffic should be continue to flow.<br>3. The ingress IXIA port should be receiving PFCs for the lossless priority traffic.<br>4. On receiving the PFCs, the IXIA-ingress should reduce the lossless traffic to around 60Gbps.<br>5. No drop for lossy and lossless traffic.   |
|           02 | Single 100Gbps Ingress and single 100Gbps egress - 1024B packet-size                              | - 90% of 400Gbps - Lossless Prio3 & Prio4<br>- 10% of 400Gbps - Lossy Background Flow [Prio0, 1, and 2]<br>- Enable pfcwd and credit-watchdog on ingress and egress.                                                                                                             | - Single LC - Multiple ASIC <br>- Multiple LC | 1. There should be NO packet drops on the DUT (IXIA Tx packets == IXIA Rx packets) <br>2. There should no PFCs on IXIA Tx port or on the DUT. <br>3. Measure latency of the packets traversing the DUT. <br>4. Expected throughput of linerate on the egress port of DUT.                                                                                                    |
|           03 | Single 400Gbps Ingress and single 400Gbps egress <br> Internet packet-size (128-1400bytes)        | - 90% of 400Gbps - Lossless Prio3 & Prio4<br>- 10% of 400Gbps - Lossy Background Flow [Prio0, 1, and 2]<br>- Enable pfcwd and credit-watchdog on ingress and egress.                                                                                                             | - Single LC - Multiple ASIC <br>- Multiple LC | 1. There should be NO packet drops on the DUT (IXIA Tx packets == IXIA Rx packets) <br>2. There should no PFCs on IXIA Tx port or on the DUT. <br>3. Measure latency of the packets traversing the DUT. <br>4. Expected throughput of linerate on the egress port of DUT.                                                                                                    |
|           04 | Single 100Gbps Ingress and single 100Gbps egress <br> Internet packet-size (128-1400bytes)        | - 90% of 400Gbps - Lossless Prio3 & Prio4<br>- 10% of 400Gbps - Lossy Background Flow [Prio0, 1, and 2]<br>- Enable pfcwd and credit-watchdog on ingress and egress.                                                                                                             | - Single LC - Multiple ASIC <br>- Multiple LC | 1. There should be NO packet drops on the DUT (IXIA Tx packets == IXIA Rx packets) <br>2. There should no PFCs on IXIA Tx port or on the DUT. <br>3. Measure latency of the packets traversing the DUT. <br>4. Expected throughput of linerate on the egress port of DUT.                                                                                                    |
|           05 | Two 100Gbps Ingress and single 100Gbps egress <br> PFCWD DROP test - 1024B packet-size            | - 30% of 100Gbps - Lossless Prio3 & Prio4 (30Gbps per ingress) <br>- No Lossy Background Flow [Prio0, 1, and 2] <br>- Enable PFCWD with "action" set to DROP(default)<br>- Send continuous PFC for lossless Priorities for configured interval.                                  | - Single LC - Multiple ASIC <br>- Multiple LC | 1. All lossy background flows dropped on DUT when the PFC is sent to DUT egress. Egress port is in 'stormed' mode. <br>2. PFCWD drop counter should increment. <br> 3. After the PFC packets are stopped, the egress port is moves to "operational state" and storm-restored counter increments.                                                                             |         
|           06 | Two 100Gbps Ingress and single 100Gbps egress <br> PFCWD FORWARD test - 1024B packet-size         | - 30% of 100Gbps - Lossless Prio3 & Prio4 (30Gbps per ingress) <br>- No Lossy Background Flow [Prio0, 1, and 2] <br>- Enable PFCWD with "action" set to FORWARD(default)<br>- Send continuous PFC for lossless Priorities for configured interval.                               | - Single LC - Multiple ASIC <br>- Multiple LC | 1. There should be no packet drops on DUT for lossy background flows. <br>2. The Prio3 and prio4 packets are stored in queue and PFCs are sent to ingress to stem the flow of ingress packets.<br>3. After the PFC packets are stopped, the lossless PRIO traffic should resume back without any drops.<br>4. PFCWD drop counters should not increment.                      |         
|           07 | Two 400Gbps Ingress and single 400Gbps egress <br> PFCWD DROP test - 1024B packet-size            | - 30% of 400Gbps - Lossless Prio3 & Prio4 (30Gbps per ingress) <br>- No Lossy Background Flow [Prio0, 1, and 2] <br>- Enable PFCWD with "action" set to DROP(default)<br>- Send continuous PFC for lossless Priorities for configured interval.                                  | - Single LC - Multiple ASIC <br>- Multiple LC | 1. All lossy background flows dropped on DUT when the PFC is sent to DUT egress. Egress port is in 'stormed' mode. <br>2. PFCWD drop counter should increment. <br> 3. After the PFC packets are stopped, the egress port is moves to "operational state" and storm-restored counter increments.                                                                             |         
|           08 | Two 400Gbps Ingress and single 400Gbps egress <br> PFCWD FORWARD test - 1024B packet-size         | - 30% of 400Gbps - Lossless Prio3 & Prio4 (30Gbps per ingress) <br>- No Lossy Background Flow [Prio0, 1, and 2] <br>- Enable PFCWD with "action" set to FORWARD(default)<br>- Send continuous PFC for lossless Priorities for configured interval.                               | - Single LC - Multiple ASIC <br>- Multiple LC | 1. There should be no packet drops on DUT for lossy background flows. <br>2. The Prio3 and prio4 packets are stored in queue and PFCs are sent to ingress to stem the flow of ingress packets.<br>3. After the PFC packets are stopped, the lossless PRIO traffic should resume back without any drops.<br>4. PFCWD drop counters should not increment.                      |         
|           09 | Two 100Gbps Ingress and single 100Gbps egress <br> Equal traffic for all priorities               | - 24% -  Prio3 & Prio4(24Gbps) per ingress LC <br>- 36% Background flows [Prio0, 1, and 2] (36Gbps) per ingress LC <br>- 60Gbps of Prio3 and Prio4 traffic + 60Gbps of Background flows <br>- Enabled PFCWD and credit-watchdog on ingress and egress.                           | - Single LC - Multiple ASIC <br>- Multiple LC | 1. Packet drops for Lossy Traffic. <br>2. PFCs for lossless traffic. No packet drops for losslesss traffic. <br>3. Expected throughput of 100Gbps (Lossless + lossy traffic only) on egress interface of DUT. <br>4. Expected close to equal throughput for all priorities.                                                                                                  |         
|           10 | Two 400Gbps Ingress and single 400Gbps egress <br> Equal traffic for all priorities               | - 24% -  Prio3 & Prio4(96Gbps) per ingress LC <br>- 36% Background flows [Prio0, 1, and 2] (144Gbps) per ingress LC <br>- 192Gbps of Prio3 and Prio4 traffic + 288Gbps of Background flows <br>- Enabled PFCWD and credit-watchdog on ingress and egress                         | - Single LC - Multiple ASIC <br>- Multiple LC | 1. Packet drops for Lossy Traffic. <br>2. PFCs for lossless traffic. No packet drops for losslesss traffic. <br>3. Expected throughput of 400Gbps (Lossless + lossy traffic only) on egress interface of DUT. <br>4. Expected close to equal throughput for all priorities.                                                                                                  |         
|           11 | Two 100Gbps Ingress and single 100Gbps egress <br> Unequal traffic lossy and lossless priorities. | - 90% of 100Gbps - Lossless Prio3 & Prio4<br>- 10% of 100Gbps - Lossy Background Flow [Prio0, 1, and 2]                                                                                                                                                                          | - Single LC - Multiple ASIC <br>- Multiple LC | 1. No packet drops for Lossy Traffic. <br>2. PFCs for lossless traffic. No packet drops for losslesss traffic. <br>3. Expected throughput of 100Gbps (Lossless + lossy traffic only) on egress interface of DUT. <br>                                                                                                                                                        |         
|           12 | Two 400Gbps Ingress and single 400Gbps egress <br> Unequal traffic lossy and lossless priorities. | - 90% of 400Gbps - Lossless Prio3 & Prio4<br>- 10% of 400Gbps - Lossy Background Flow [Prio0, 1, and 2]                                                                                                                                                                          | - Single LC - Multiple ASIC <br>- Multiple LC | 1. No packet drops for Lossy Traffic. <br>2. PFCs for lossless traffic. No packet drops for losslesss traffic. <br>3. Expected throughput of 400Gbps (Lossless + lossy traffic only) on egress interface of DUT. <br>                                                                                                                                                        |
|           13 | Single 100Gbps Ingress and single 100Gbps egress - MACSEC                                         | - 90% of 100Gbps - Lossless Prio3 & Prio4<br>- 10% of 100Gbps - Lossy Background Flow [Prio0, 1, and 2]                                                                                                                                                                          | - Single LC - Multiple ASIC <br>- Multiple LC | 1. There should be NO packet drops on the DUT (IXIA Tx packets == IXIA Rx packets) <br>2. There should no PFCs on IXIA Tx port or on the DUT.<br>3. Measure latency of the packets traversing the DUT. <br>4. Expected throughput of linerate on the egress port of DUT.                                                                                                     |         
|           14 | Single 100Gbps Ingress and single 100Gbps egress - PFC over MACSEC                                | - 90% of 100Gbps - Lossless Prio3 & Prio4<br>- 10% of 100Gbps - Lossy Background Flow [Prio0, 1, and 2] <br>3. Disable PFCWD before the test. <br>4. Send pause to the egress direction.                                                                                         | - Single LC - Multiple ASIC <br>- Multiple LC | 1. There should be NO packet drops on the DUT (IXIA Tx packets == IXIA Rx packets) <br>2. There should be PFCs on IXIA and DUT - Tx and Rx port.<br>3. The PFCs from IXIA-Rx should stop IXIA-Tx from sending any traffic. <br>4. Only 10% of lossy traffic on the DUT.                                                                                                      |         
|           15 | Single 100Gbps Ingress and single 100Gbps egress - PFCWD(Drop) over MACSEC                        | - 90% of 400Gbps - Lossless Prio3 & Prio4<br>- 10% of 400Gbps - Lossy Background Flow [Prio0, 1, and 2] <br>3. Enabled PFCWD in default mode before the test. <br>4. Send pause to the egress from IXIA Rx.                                                                      | - Single LC - Multiple ASIC <br>- Multiple LC | 1. There should be packet drops on the DUT (IXIA Tx packets > IXIA Rx packets). <br>2. There should PFCs on IXIA Rx port but not on DUT Rx port <br>3. Only 10% of lossy traffic should flow. <br>4. PFCWD drop counter should increment <br>5. DUT Rx port should be in 'stormed' mode.                                                                                     |         
|           16 | Single 400Gbps Ingress and single 400Gbps egress - PFC over MACSEC                                | - 90% of 400Gbps - Lossless Prio3 & Prio4<br>- 10% of 400Gbps - Lossy Background Flow [Prio0, 1, and 2] <br>3. Disable PFCWD before the test. <br>4. Send pause to the egress direction.                                                                                         | - Single LC - Multiple ASIC <br>- Multiple LC | 1. There should be NO packet drops on the DUT (IXIA Tx packets == IXIA Rx packets) <br>2. There should be PFCs on IXIA and DUT - Tx and Rx port.<br>3. The PFCs from IXIA-Rx should stop IXIA-Tx from sending any traffic. <br>4. Only 10% of lossy traffic on the DUT.                                                                                                      |         
|           17 | Single 400Gbps Ingress and single 400Gbps egress - PFCWD(Drop) over MACSEC                        | - 90% of 400Gbps - Lossless Prio3 & Prio4<br>- 10% of 400Gbps - Lossy Background Flow [Prio0, 1, and 2] <br>3. Enabled PFCWD in default mode before the test. <br>4. Send pause to the egress from IXIA Rx.                                                                      | - Single LC - Multiple ASIC <br>- Multiple LC | 1. There should be packet drops on the DUT (IXIA Tx packets > IXIA Rx packets). <br>2. There should PFCs on IXIA Rx port but not on DUT Rx port <br>3. Only 10% of lossy traffic should flow. <br>4. PFCWD drop counter should increment <br>5. DUT Rx port should be in 'stormed' mode.                                                                                     |
|           18 | Single 100Gbs ingress and single 100Gbps egress <br> ECN congestion and packet-marking test.<br>  | - Disable PFCWD <br>- 90% of 100Gbps - Lossless Prio3 & Prio4<br>- 10% of 100Gbps - Lossy Background Flow [Prio0, 1, and 2] <br>- Send PFC storm to the egress implying ECN congestion. <br>- Stop the PFC storm. <br>- Monitor set of packets to ensure packets are ECN-marked. | - Single LC - Multiple ASIC <br>- Multiple LC | 1. PFC storm should stop the packets coming DUT ingress. <br>2. No packets going out of egress port during storm. <br>3. The captured packet on egress, once storm is stopped should be ECN-marked.                                                                                                                                                                          |         
|           19 | Single 400Gbs ingress and single 400Gbps egress <br> ECN congestion and packet-marking test.<br>  | - Disable PFCWD <br>- 90% of 400Gbps - Lossless Prio3 & Prio4<br>- 10% of 400Gbps - Lossy Background Flow [Prio0, 1, and 2] <br>- Send PFC storm to the egress implying ECN congestion. <br>- Stop the PFC storm. <br>- Monitor set of packets to ensure packets are ECN-marked. | - Single LC - Multiple ASIC <br>- Multiple LC | 1. PFC storm should stop the packets coming DUT ingress. <br>2. No packets going out of egress port during storm. <br>3. The captured packet on egress, once storm is stopped should be ECN-marked.                                                                                                                                                                          |         


Note - Did not include Testcase#9, 13 and 14 from the spreadsheet as they are more related to portchannels rather than QoS and PFCs.